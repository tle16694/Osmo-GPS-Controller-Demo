# DJI Osmo Action 5 Pro – Single‑Button BLE Remote (ESP32 DevKit)

เฟิร์มแวร์นี้พอร์ตจากเดโมอย่างเป็นทางการของ DJI เพื่อทำรีโมต BLE แบบ “ปุ่มเดียว” สำหรับ ESP32 DevKit (ESP‑WROOM‑32) โดยออกแบบให้ใช้งานได้จริงในเชิงพาณิชย์: จับคู่/เชื่อมต่อใหม่อัตโนมัติ, คำสั่งหลักครบ, และมีโหมดประหยัดพลังงาน

## ความสามารถหลัก
- เชื่อมต่อ BLE + โปรโตคอล DJI R SDK เพื่อควบคุมกล้อง
- ปุ่มเดียว: อัด/หยุดอัด, เปลี่ยนโหมด, ถ่ายภาพ, จับคู่/เชื่อมต่อใหม่, ล้างการจับคู่
- จดจำกล้องล่าสุดใน NVS และ auto‑reconnect ตอนบูต
- ไม่ต้องมี GNSS / GPS (ค่าเริ่มต้นปิด)
- LED เดี่ยว (GPIO33) แสดงสถานะชัดเจน
- เมื่อไม่เชื่อมต่อและไม่มีการกดปุ่ม 5 นาที จะเข้าสู่ light sleep และตื่นด้วยปุ่ม

## การใช้งาน (ปุ่มเดียว)
หน้าต่างนับหลายคลิก: 380ms หลัง “ปล่อยปุ่ม” ครั้งสุดท้าย

- 1 คลิก: RECORD_TOGGLE (เริ่ม/หยุดอัด)
- 2 คลิก: MODE_NEXT (Quick Switch / เปลี่ยนโหมดถัดไป)
- 3 คลิก: TAKE_PHOTO (ถ่ายภาพ)
- กดค้าง ≥ 2.0s: PAIR_OR_RECONNECT (จับคู่/เชื่อมต่อใหม่)
- กดค้าง ≥ 7.0s: FACTORY_RESET_LINK (ล้างการจดจำกล้อง + บังคับจับคู่ใหม่)

## รูปแบบไฟ LED (GPIO33, LED เดียว)
- BOOT: ติด 800ms แล้วดับ 200ms (ครั้งเดียว)
- READY (ยังไม่เชื่อมต่อ): ติด 120ms / ดับ 880ms
- CONNECTING: ติด 80ms / ดับ 120ms
- CONNECTED (โปรโตคอลพร้อม): ติดค้าง
- RECORDING: ติด 180ms / ดับ 820ms
- ERROR: กระพริบ 70/70ms จำนวน 3 ครั้ง แล้วพัก 700ms (วนซ้ำช่วงสั้น ๆ)

## การจับคู่ครั้งแรก
1) เปิดกล้องและเปิด BLE/รีโมตคอนโทรลของกล้อง (ตามเมนูกล้อง)
2) กดค้างปุ่มรีโมต ≥ 2.0s
3) ไฟจะเข้า CONNECTING และกล้องอาจขึ้นหน้าต่างยืนยัน/รหัส (ขึ้นกับสถานะการจับคู่)
4) หลังเชื่อมต่อสำเร็จ ไฟจะติดค้าง (CONNECTED)

## การเชื่อมต่ออัตโนมัติ
- ถ้าเคยจับคู่แล้ว: รีโมตจะพยายามเชื่อมต่อกล้องล่าสุดอัตโนมัติหลังบูต
- ถ้าเชื่อมต่อกล้องล่าสุดไม่สำเร็จ: จะ fallback ไปสแกนหา “กล้องที่เข้ากันได้ที่ใกล้ที่สุด”

## ล้างการจับคู่ (Factory Reset Link)
กดค้างปุ่ม ≥ 7.0s เพื่อ:
- ล้างข้อมูลที่จดจำกล้องใน NVS
- บังคับเข้าสู่โหมดจับคู่ใหม่ (CONNECTING)

## ข้อควรทราบ
- ปุ่ม BOOT บนบอร์ด ESP32 ใช้สำหรับแฟลชเท่านั้น ไม่ถูกใช้เป็น UI
- หากกด RECORD_TOGGLE ตอนกล้องอยู่โหมดภาพนิ่ง เฟิร์มแวร์จะพยายามสลับไปโหมดวิดีโอแล้วค่อยเริ่มอัด
- การถ่ายภาพ: ถ้า “ชัตเตอร์ตรง” ไม่ตอบสนอง เฟิร์มแวร์จะสลับไปโหมดภาพนิ่งแล้วลองถ่ายซ้ำ

